<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mestres de Aluguel RPG | Portal da Guilda</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Lato:wght@300;400;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --primary: #D4AF37;
            --bg-dark: #050505;
            --bg-card: #111;
            --text-main: #e0e0e0;
            --text-muted: #888;
            --overlay: rgba(0, 0, 0, 0.75);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            background-color: var(--bg-dark);
            color: var(--text-main);
            font-family: 'Lato', sans-serif;
            line-height: 1.6;
            overflow-x: hidden;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        h1, h2, h3, .nav-link, .btn-hero, .btn-buy, .logo {
            font-family: 'Cinzel', serif;
        }

        header {
            background: rgba(5, 5, 5, 0.9);
            padding: 20px 5%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #333;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            backdrop-filter: blur(8px);
        }

        .logo {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--primary);
            text-decoration: none;
            text-transform: uppercase;
            letter-spacing: 2px;
            border: 2px solid var(--primary);
            padding: 5px 15px;
        }

        .nav-links a {
            margin-left: 25px;
            text-decoration: none;
            color: var(--text-main);
            font-size: 0.9rem;
            transition: 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .nav-links a:hover {
            color: var(--primary);
        }

        .hero {
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 0 20px;
            position: relative;
            background: radial-gradient(circle at center, #1a1a1a 0%, #000000 100%);
        }

        .hero::before {
            content: '';
            position: absolute;
            inset: 0;
            background: var(--overlay);
        }

        .hero-content {
            position: relative;
            z-index: 1;
            max-width: 800px;
        }

        .hero h1 {
            font-size: 3.5rem;
            color: var(--primary);
            margin-bottom: 20px;
            text-transform: uppercase;
        }

        .hero p {
            font-size: 1.2rem;
            color: #ccc;
            margin-bottom: 40px;
        }

        .btn-hero {
            padding: 16px 40px;
            border: 2px solid var(--primary);
            color: var(--primary);
            text-decoration: none;
            text-transform: uppercase;
            letter-spacing: 2px;
            transition: 0.3s;
        }

        .btn-hero:hover {
            background: var(--primary);
            color: #000;
        }

        #welcome-section {
            display: none;
            padding-top: 140px;
            text-align: center;
        }

        .user-badge {
            border: 1px solid #444;
            background: #111;
            padding: 10px 30px;
            display: inline-block;
            color: var(--primary);
            font-family: 'Cinzel', serif;
        }

        .grid-section {
            padding: 60px 5%;
            max-width: 1400px;
            margin: 0 auto;
            display: none;
            flex: 1;
        }

        .section-title {
            text-align: center;
            font-size: 2.2rem;
            margin-bottom: 60px;
        }

        .cards-container {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 40px;
        }

        .rpg-card {
            background: var(--bg-card);
            border: 1px solid #333;
            width: 340px;
            overflow: hidden;
            transition: 0.3s;
        }

        .rpg-card:hover {
            transform: translateY(-8px);
            border-color: var(--primary);
        }

        .card-header {
            height: 200px;
            background: #222;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Cinzel';
            color: #777;
        }

        .card-body {
            padding: 30px;
        }

        .card-body h3 {
            margin-bottom: 15px;
        }

        .card-detail {
            display: flex;
            justify-content: space-between;
            border-bottom: 1px solid #222;
            padding-bottom: 8px;
            margin-bottom: 8px;
            color: var(--text-muted);
        }

        .price-tag {
            display: block;
            text-align: center;
            font-size: 1.3rem;
            color: var(--primary);
            margin: 25px 0;
        }

        .btn-buy {
            width: 100%;
            padding: 15px;
            background: var(--primary);
            border: none;
            cursor: pointer;
            font-weight: bold;
            text-transform: uppercase;
        }

        footer {
            text-align: center;
            padding: 40px 20px;
            background: #080808;
            border-top: 1px solid #222;
            color: #666;
        }
    </style>
</head>
<body>

<header>
    <a href="#" class="logo">Mestres de Aluguel</a>
    <nav class="nav-links">
        <a href="https://discord.gg/d9Ym4P9zNw" target="_blank">Discord</a>
        <a href="https://www.facebook.com/MestresDeAluguelRPG" target="_blank">Facebook</a>
    </nav>
</header>

<div id="hero-section" class="hero">
    <div class="hero-content">
        <h1>Forje sua Lenda</h1>
        <p>Encontre mestres experientes e viva aventuras inesquecíveis.</p>
        <a href="/auth/discord" class="btn-hero">Entrar com Discord</a>
    </div>
</div>

<div id="welcome-section">
    <div class="user-badge">
        ⚜️ Saudações, <span id="username-display">Viajante</span>
    </div>
</div>

<section id="aventuras-section" class="grid-section">
    <h2 class="section-title">Mesas Disponíveis</h2>

    <div class="cards-container">

        <!-- MESA 1 -->
        <div class="rpg-card">
            <div class="card-header">Curse of Strahd</div>
            <div class="card-body">
                <h3>Curse of Strahd: Reloaded</h3>
                <div class="card-detail"><span>Mestre</span><span>Arboreal</span></div>
                <div class="card-detail"><span>Sistema</span><span>D&D 5e</span></div>
                <div class="card-detail"><span>Dia</span><span>Sextas-feiras</span></div>
                <span class="price-tag">R$ 130 / mês</span>
                <button class="btn-buy"
                    onclick="criarSessao('1443344623908032603', 'Curse of Strahd: Reloaded')">
                    Assinar Contrato
                </button>
            </div>
        </div>

        <!-- MESA 2 -->
        <div class="rpg-card">
            <div class="card-header">Ethelon</div>
            <div class="card-body">
                <h3>Ethelon: Reinos das Alianças Quebradas</h3>
                <div class="card-detail"><span>Mestre</span><span>Mestre Berbari</span></div>
                <div class="card-detail"><span>Sistema</span><span>D&D 2024</span></div>
                <div class="card-detail"><span>Frequência</span><span>2x por mês</span></div>
                <span class="price-tag">R$ 130 / mês</span>
                <button class="btn-buy"
                    onclick="criarSessao('1463336420935729247', 'Ethelon: Reinos das Alianças Quebradas')">
                    Assinar Contrato
                </button>
            </div>
        </div>

    </div>
</section>

<footer>
    <p>&copy; 2025 Mestres de Aluguel RPG</p>
</footer>

<script>
    window.onload = function () {
        const params = new URLSearchParams(window.location.search);
        const username = params.get('username');
        const discordId = params.get('discord_id');

        if (username && discordId) {
            document.getElementById('hero-section').style.display = 'none';
            document.getElementById('welcome-section').style.display = 'block';
            document.getElementById('aventuras-section').style.display = 'block';
            document.getElementById('username-display').textContent = username;
        }
    };

    async function criarSessao(idCargoDiscord, nomeAventura) {
        const params = new URLSearchParams(window.location.search);
        const discordId = params.get('discord_id');

        const response = await fetch('/create-checkout-session', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ discordId, idCargoDiscord, nomeAventura })
        });

        const data = await response.json();
        if (data.url) window.location.href = data.url;
    }
</script>

</body>
</html>
